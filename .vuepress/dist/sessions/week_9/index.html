<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Week 9 - Managing Data Using Firebase</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.18a9a872.js" as="script"><link rel="preload" href="/assets/js/2.3f5ee22a.js" as="script"><link rel="preload" href="/assets/js/16.f5936851.js" as="script"><link rel="prefetch" href="/assets/js/10.87cde8f2.js"><link rel="prefetch" href="/assets/js/11.a2c3fe41.js"><link rel="prefetch" href="/assets/js/12.82fa8f69.js"><link rel="prefetch" href="/assets/js/13.b3090127.js"><link rel="prefetch" href="/assets/js/14.054b7323.js"><link rel="prefetch" href="/assets/js/15.b3ee38a4.js"><link rel="prefetch" href="/assets/js/17.a2df7aab.js"><link rel="prefetch" href="/assets/js/18.ec3c656d.js"><link rel="prefetch" href="/assets/js/19.49300105.js"><link rel="prefetch" href="/assets/js/20.9250f9a5.js"><link rel="prefetch" href="/assets/js/21.c9cd9070.js"><link rel="prefetch" href="/assets/js/22.08b16531.js"><link rel="prefetch" href="/assets/js/23.99f6c2e2.js"><link rel="prefetch" href="/assets/js/24.65404243.js"><link rel="prefetch" href="/assets/js/25.0eae5c5e.js"><link rel="prefetch" href="/assets/js/26.a36254fa.js"><link rel="prefetch" href="/assets/js/27.6ffa9ea5.js"><link rel="prefetch" href="/assets/js/28.b9112019.js"><link rel="prefetch" href="/assets/js/29.0afded7b.js"><link rel="prefetch" href="/assets/js/3.675895e2.js"><link rel="prefetch" href="/assets/js/4.b742f9a0.js"><link rel="prefetch" href="/assets/js/5.97dda308.js"><link rel="prefetch" href="/assets/js/6.69f62386.js"><link rel="prefetch" href="/assets/js/7.7b272e32.js"><link rel="prefetch" href="/assets/js/8.d2b6e6ac.js"><link rel="prefetch" href="/assets/js/9.793be682.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="week-9-managing-data-using-firebase"><a href="#week-9-managing-data-using-firebase" class="header-anchor">#</a> Week 9 - Managing Data Using Firebase</h1> <iframe width="560" height="315" src="https://www.youtube.com/embed/l_0OpoGtigw" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe> <h3 id="how-can-i-persist-data-in-my-web-applications"><a href="#how-can-i-persist-data-in-my-web-applications" class="header-anchor">#</a> How can I persist data in my web applications?</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <h2 id="session-dependencies"><a href="#session-dependencies" class="header-anchor">#</a> Session Dependencies</h2> <p><a href="http://github.com/joeappleton18/contemp-web-app-solutions.git" target="_blank" rel="noopener noreferrer">Make sure that you have the latest of the ongoing class, fitness tracker, project. <strong>The notes for this week refer extensively to this project</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Ensure you have the latest version of this project.</p> <p>This week's, and future, setups are a little more involved. You will need to ensure that you add your own firebase credentials. The <code>README.md</code> file on my version of the fitness tracker walks you through how to do this.</p></div> <h3 id="essential-reading"><a href="#essential-reading" class="header-anchor">#</a> Essential Reading ðŸ“•</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li><a href="https://firebase.google.com/docs/firestore" target="_blank" rel="noopener noreferrer">The cloud firestore overview<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://firebase.google.com/docs/firestore/data-model" target="_blank" rel="noopener noreferrer">The cloud firestore data model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <h3 id="optional-reading"><a href="#optional-reading" class="header-anchor">#</a> Optional Reading ðŸ“•</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li><a href="https://www.youtube.com/watch?v=G04w_k3TPTs&amp;t=131s" target="_blank" rel="noopener noreferrer">Not reading but watching, this is a tutorial by Tod, the firebase developer advocate, on structuring firebase data. I suggest you jump to the sections on data structuring<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>This week, we are going to be exploring cloud Firestore, the database offering by Firebase. Out of the box, we get a powerful, scalable database.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Do not confuse Firestore with the Realtime Database. The Realtime database is a older, more simplistic, database product. For new projects you should be using Firestore.</p></div> <h2 id="a-little-bit-about-the-firestore-database"><a href="#a-little-bit-about-the-firestore-database" class="header-anchor">#</a> A little bit about the Firestore database</h2> <p>Cloud Firestore is a NoSQL, document-oriented database. There are three main types of NoSQL-databases: document-based, column-based and graph-base. Cloud Firestore is of the document-based variety.</p> <p>In a document-based database, your application's data is stored in documents in a JSON like structure. Documents live in collections. If you come from a relational database world, collections are like tables. If your application requires it, you can also structure sub-collections within documents. We will explore how this works through examples. As this is not a database unit, I am not overly focusing on data modeling.</p> <p>One of the fundamental rules of non-relational data modeling is we try and represent data from a user-first perspective. In other words, we want to structure our data so it can be simply displayed in our application's users interface.</p> <h2 id="setting-up-the-firestore-database"><a href="#setting-up-the-firestore-database" class="header-anchor">#</a> Setting up the Firestore Database</h2> <p><img src="/assets/img/fig_1.859ae8a2.png" alt=""></p> <blockquote><blockquote><p>Figure 1, creating a database</p></blockquote></blockquote> <p>Creating a database for your project is simple:</p> <ul><li><p>In your firebase project, select Database from the left-hand-side, develop menu section</p></li> <li><p>Next, click the <code>Create database</code></p></li> <li><p>We want to start off in test mode, so select this option when prompted</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-1-setting-up-a-database"><a href="#task-1-setting-up-a-database" class="header-anchor">#</a> Task 1 - Setting up a database</h2> <p>Follow the steps above to set up your database - ensure that you set it up in &quot;test&quot; mode.</p></div> <h2 id="structuring-data"><a href="#structuring-data" class="header-anchor">#</a> Structuring Data</h2> <p>Remember, the data in our database is created from the perspective of a user. To highlight this point let's consider, first, our check-in functionality and data that it outputs.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-2-exploring-the-check-in-data"><a href="#task-2-exploring-the-check-in-data" class="header-anchor">#</a> Task 2 - Exploring the check-in data</h2> <ul><li>Log-in to your application</li> <li>Navigate to the <code>/checkin</code>. You can use the link in the menu or just type the URL in</li> <li>Next, within <code>Views/Checkin.js</code> work out how to set up a <code>handleSubmit</code> function that logs to the console the checkin.</li></ul> <HiddenSection display-text="click me for a hint"><ul><li><p>Add a <code>onSubmit()</code> event handler to the CheckInForm component: <code>&lt;CheckinForm onSubmit={handleSubmit}/&gt;</code></p></li> <li><p>Set up an event handler function within your Checkin function:</p></li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token operator">...</span>
 <span class="token keyword">const</span> <span class="token function-variable function">Checkin</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token parameter">checkin</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>checkin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre></div></HiddenSection></div> <p>On completing the above task you will have seen that our check-in data looks like this:</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code> <span class="token punctuation">{</span>
        exercise<span class="token operator">:</span> <span class="token number">5</span>
        veg<span class="token operator">:</span> <span class="token number">3</span>
        water<span class="token operator">:</span> <span class="token number">2</span>
        diet<span class="token operator">:</span> <span class="token number">7</span>
        comment<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span>
        total<span class="token operator">:</span> <span class="token number">20</span>
        drinkPen<span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
        foodPen<span class="token operator">:</span> <span class="token string">&quot;2&quot;</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>The above data structure is close to resembling a document that could be stored in our database. However, look at our application's main dash and you can see that we do not have enough information to display a check-in. For now, I am most concerned that we are missing a userName, userId and photo. This information needs to be added to our check-in object.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>You may think, why not just add a userId to our check-in and we could look the rest up. Remember, though, we are optimising for quick reads and data structures that resemble our UI. Yes, we are duplicating data; however, this idea, know as denormalisation, is fine in the NoSQL world.</p></div> <p>With the above mantras in mind we want to create the following data structure:</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>
    <span class="token punctuation">{</span>
        exercise<span class="token operator">:</span> <span class="token number">5</span>
        veg<span class="token operator">:</span> <span class="token number">3</span>
        water<span class="token operator">:</span> <span class="token number">2</span>
        diet<span class="token operator">:</span> <span class="token number">7</span>
        comment<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span>
        total<span class="token operator">:</span> <span class="token number">20</span>
        drinkPen<span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
        foodPen<span class="token operator">:</span> <span class="token string">&quot;2&quot;</span>
        <span class="token comment">// additional fields</span>
        photo<span class="token operator">:</span> <span class="token string">&quot;joephotourl&quot;</span>
        userName<span class="token operator">:</span> <span class="token string">&quot;joe appleton&quot;</span>
        userId<span class="token operator">:</span> <span class="token string">&quot;vDyPgsU41CMrFK29bmN4lULK6JN2&quot;</span><span class="token punctuation">,</span>
        time<span class="token operator">:</span> <span class="token string">&quot;Wed Mar 18 2020 10:03:31 GMT+0000 (Greenwich Mean Time)&quot;</span>
    <span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-3-denormalisation-of-the-checkin-data"><a href="#task-3-denormalisation-of-the-checkin-data" class="header-anchor">#</a> Task 3 - Denormalisation of the checkin data</h2> <ul><li><p>Can you structure our current checkin object so it resembles our data structure above</p></li> <li><p>First, you will need to pass our user from App.js down to our Checkin component.</p> <ul><li>In <code>App.js</code> pass our user, which has been exported from useAuth, into the checkin component <code>&lt;Checkin createCheckin={createCheckin} user={user} /&gt;</code></li> <li>Within checkin, set up a <code>user</code> <code>prop-type</code></li> <li>See if you can amend the <code>handleSubmit</code> function so it adds the extra user fields to our checkin object when the form submits.</li> <li>There is a slight gotcha, if someone has signed up using email or Google they may not have a userName in which case we want to use their email instead (users always have an email). In JavaScript, you can use the following technique to assign a default value:</li></ul> <p><code>const userName = user.displayName || user.email</code>;</p></li></ul> <HiddenSection display-text="hint"><div class="language- extra-class"><pre><code>const handleSubmit =  async checkin =&gt; {

    const ckin = {...checkin,
                  ...{photo: user.photoURL,
                      userId: user.uid,
                      userName: user.displayName || user.email,
                      time: new Date()}}
}
</code></pre></div></HiddenSection></div> <h2 id="reading-and-writing-to-our-database"><a href="#reading-and-writing-to-our-database" class="header-anchor">#</a> Reading and Writing to Our Database</h2> <h2 id="writing-data"><a href="#writing-data" class="header-anchor">#</a> Writing Data</h2> <p>To use the firestore database in our application, we first need to import it.</p> <ul><li><p>Within <code>/src/App.js</code> add <code>import &quot;firebase/firestore&quot;;</code> to your imports. Make sure it is after the firebase import.</p></li> <li><p>Next, we are going to create a <code>useCheckin</code> service hook that will manage our check-in's collection.</p></li> <li><p>Create a <code>src/services/firebase/useCheckin.js</code> file and add the following code:</p></li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useCheckins</span><span class="token punctuation">(</span><span class="token parameter">fStore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">fStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'checkins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">createCheckin</span>  <span class="token operator">=</span> <span class="token parameter">checkin</span> <span class="token operator">=&gt;</span> ref<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>checkin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">readCheckin</span> <span class="token operator">=</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span>  ref<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">readCheckins</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>create<span class="token punctuation">,</span> read<span class="token punctuation">,</span> list<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useCheckins<span class="token punctuation">;</span>

</code></pre></div><p>Let's unpack what we are doing above:</p> <ul><li><p><code>fStore</code> is a reference to our database that will be passed in by app</p></li> <li><p><code>const ref = fStore().collection('checkins');</code> is a pointer to a checkins collection in our database. If the collection does not exist it will be created, it will be automatically created when the first document is written to the collection</p></li> <li><p>We then use the above ref set up functions to add a new checkin <code>ref.add(checkin);</code> and also to read our all of the checkin documents from our collection <code>ref.get();</code></p></li> <li><p>Finally, we return our functions so they can be used in other components: <code>return {createCheckin, readCheckin, listCheckin}</code></p></li> <li><p>We are now ready to use our checkin hook in our <code>src/App.js</code> component:</p> <ul><li>If you have not done so already, <code>import &quot;firebase/firestore&quot;;</code></li> <li>Also, import the checkIn hook: <code>import useCheckin from &quot;./services/firebase/useCheckin&quot;;</code></li> <li>Finally, within your app component, call your checkin hook like this:</li></ul></li> <li><div class="language-JavaScript extra-class"><pre class="language-javascript"><code>
 <span class="token operator">...</span>
     <span class="token keyword">const</span> <span class="token punctuation">{</span>
        createCheckin<span class="token punctuation">,</span>
        readCheckins
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useCheckins</span><span class="token punctuation">(</span>firebase<span class="token punctuation">.</span>firestore<span class="token punctuation">)</span>
 <span class="token operator">...</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-4-make-your-first-database-write"><a href="#task-4-make-your-first-database-write" class="header-anchor">#</a> Task 4 - Make your first database write</h2> <ul><li><p>Pass the checkin <code>createCheckin</code> function down to our <code>checkIn</code> view as a prop</p></li> <li><p>See if you can write a checkin to the database</p> <HiddenSection display-text="hint 1"><div class="language- extra-class"><pre><code>       &lt;Checkin  createCheckin={createCheckin}  user={user} /&gt;
</code></pre></div></HiddenSection></li> <li><p>This is what my final Checkin component looks like:</p></li></ul></div></li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">const</span> <span class="token function-variable function">Checkin</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span>  <span class="token punctuation">{</span>user<span class="token punctuation">,</span> createCheckin<span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span>  <span class="token keyword">async</span> <span class="token parameter">checkin</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> ckin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>checkin<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span>photo<span class="token operator">:</span> user<span class="token punctuation">.</span>photoURL<span class="token punctuation">,</span> userId<span class="token operator">:</span> user<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> userName<span class="token operator">:</span> user<span class="token punctuation">.</span>displayName <span class="token operator">||</span> user<span class="token punctuation">.</span>email<span class="token punctuation">,</span> time<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token function">createCheckin</span><span class="token punctuation">(</span>ckin<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token operator">...</span><span class="token punctuation">.</span>

</code></pre></div><p>If the above worked, you should now have data in your database. Let's, finally, consider how to read the data.</p> <h2 id="reading-data"><a href="#reading-data" class="header-anchor">#</a> Reading Data</h2> <ul><li><p>Let's see if we can pull our checkins into our dash. First, from within our <code>App.js</code> component , we need to pass <code>readCheckins</code> into our dash component <code>&lt;Dash readCheckins={readCheckins} checkins={checkins} /&gt;</code></p></li> <li><p>Within our <code>Views/Dash.js</code> component we need to grab <code>readCheckins</code> from our props</p></li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Dash</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span>checkins<span class="token punctuation">,</span> readCheckins<span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>

</code></pre></div><ul><li>Next we should set up some state to hold our checkins</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>    <span class="token keyword">const</span> <span class="token punctuation">[</span>allCheckins<span class="token punctuation">,</span> setAllCheckins<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Finally we can set up an effect that calls our <code>readCheckins</code> function</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> <span class="token function-variable function">getAllCheckins</span> <span class="token operator">=</span>  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> aCheckins <span class="token operator">=</span>  <span class="token keyword">await</span> <span class="token function">readCheckins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> checkins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      aCheckins<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> checkins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setAllCheckins</span><span class="token punctuation">(</span>checkins<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">getAllCheckins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div><ul><li><p>Notice how I set up a nested async function within the useEffect function - which I immediately call. This is because React advises against making the useEffect function async as it could delay the render time.</p></li> <li><p>Firebase does not return our collection's data, instead, it provides a references to the data. The collection reference returned, provides us with a <code>forEach</code> method, which I use to construct a checkins array and set the value of that array to our <code>allCheckins</code> state.</p></li></ul> <h2 id="home-study"><a href="#home-study" class="header-anchor">#</a> Home Study</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-5-display-the-checkin-data"><a href="#task-5-display-the-checkin-data" class="header-anchor">#</a> Task 5 - Display the checkin data</h2> <ul><li>Can you update the dash so it displays checkins from our database</li> <li>At the moment you will still need to use placeholder data for the histogram, we'll solve this issue next week.</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-6"><a href="#task-6" class="header-anchor">#</a> Task 6</h2> <ul><li>Can you create a new collection and an associated hook. The collection will be called <code>Challenges</code> . For now, it will hold a single document, containing <code>challengeName</code>, <code>challengeStartDate</code>, <code>challengeEndDate</code></li> <li>See if you can use your new hook, to read the the single challenge document. You can use this data to populate the top part of our main dash</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <h2 id="task-7-advanced"><a href="#task-7-advanced" class="header-anchor">#</a> Task 7 (Advanced)</h2> <p>Can you work out how to implement the comment functionality?</p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.18a9a872.js" defer></script><script src="/assets/js/2.3f5ee22a.js" defer></script><script src="/assets/js/16.f5936851.js" defer></script>
  </body>
</html>
